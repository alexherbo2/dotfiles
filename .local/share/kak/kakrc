define-command colorscheme -params 1 -docstring 'load color scheme' %{
  source "%val{config}/colors/%arg{1}.kak"
}

complete-command -menu colorscheme shell-script-candidates %{
  find -L "$kak_config/colors" "$kak_runtime/colors" -type f -name '*.kak' -exec basename -a -s '.kak' -- {} +
}

define-command help -params 1 -docstring 'show help' %{
  edit -existing -readonly %arg{1}
}

complete-command -menu help shell-script-candidates %{
  find -L "$kak_runtime/doc" "$kak_runtime/autoload" "$kak_config/doc" "$kak_config/autoload" -type f '(' -name '*.asciidoc' -or -name '*.md' ')'
}

define-command helpgrep -params 1 -docstring 'grep help' %{
  grep %arg{1} "%val{runtime}/doc" "%val{runtime}/autoload" "%val{config}/autoload"
}

evaluate-commands %sh{
  find -L "$kak_config/autoload" -type f -name '*.kak' -exec printf 'source "%s";' {} +
}

source "%val{config}/kakrc"

evaluate-commands %sh{
  if [ -f '.kakrc' -a -r '.kakrc' ]; then
    echo "source '.kakrc'"
  fi
}
