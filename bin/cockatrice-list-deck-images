#!/bin/sh

# Defaults
XDG_DATA_HOME=${XDG_DATA_HOME:-~/.local/share}

data=$XDG_DATA_HOME/Cockatrice/Cockatrice

deck=$data/decks/$@.cod

test -e "$deck" || {
  echo 'No deck found' > /dev/stderr
  exit 1
}

regex=$(
  pcregrep -o1 '<card number="[0-9]+" name="(.+)"/>' "$deck" |
  paste -s -d '|' -
)

find $data/pics/downloadedPics |
pcregrep "$regex"
