# Options ──────────────────────────────────────────────────────────────────────

# Fixes delay in modal applications
set-option -s -g escape-time 0

# Start numbering at 1
set-option -g base-index 1 # Window
set-option -w -g pane-base-index 1

# Automatically renumber windows
set-option -g renumber-windows

# Pass focus events through to applications
set-option -g focus-events on

# Palette switching
# FAQ: I’m using tmux and colors look weird
# $ tic /path/to/kakoune/contrib/tmux-256color.terminfo
# https://github.com/mawww/kakoune/blob/master/doc/pages/faq.asciidoc#im-using-tmux-and-colors-look-weird
set-option -g default-terminal tmux-256color
set-option -g -a terminal-overrides ',*col*:Tc'

# Status line ──────────────────────────────────────────────────────────────────

# Status format for windows
# [1] 2 3
set-option -g window-status-format ' #{window_index} '
set-option -g window-status-current-format '[#{window_index}]'

# Hide status right
set-option -g status-right ''

# Bindings ─────────────────────────────────────────────────────────────────────

# Prompt
bind-key -n C-Enter command-prompt

# Reload the configuration
bind-key -n F5 {
  source-file ~/.tmux.conf
  display-message 'Reloaded configuration'
}

# [s] ⇒ Select a session.
# [S] ⇒ Create a new session.
bind-key -n C-s choose-tree -Z -s
bind-key -n C-S-s new-session

# Window
bind-key -n S-Enter new-window -c '#{pane_current_path}'

# Split
bind-key -n C-o split-window -v -c '#{pane_current_path}'
bind-key -n C-S-o split-window -h -c '#{pane_current_path}'

# Kill focused pane
bind-key -n F4 kill-pane

# Focus panes
bind-key -n C-h select-pane -L
bind-key -n C-j select-pane -D
bind-key -n C-k select-pane -U
bind-key -n C-l select-pane -R

# Move panes
bind-key -n C-S-h swap-pane -s '{left-of}'
bind-key -n C-S-j swap-pane -s '{down-of}'
bind-key -n C-S-k swap-pane -s '{up-of}'
bind-key -n C-S-l swap-pane -s '{right-of}'

# Resize panes
bind-key -n C-Left resize-pane -L 1
bind-key -n C-Down resize-pane -D 1
bind-key -n C-Up resize-pane -U 1
bind-key -n C-Right resize-pane -R 1

# Switch to window
# https://github.com/alexherbo2/tmux-tools
bind-key -n C-1 run-shell 'tmux-select-window 1'
bind-key -n C-2 run-shell 'tmux-select-window 2'
bind-key -n C-3 run-shell 'tmux-select-window 3'
bind-key -n C-4 run-shell 'tmux-select-window 4'
bind-key -n C-5 run-shell 'tmux-select-window 5'
bind-key -n C-6 run-shell 'tmux-select-window 6'
bind-key -n C-7 run-shell 'tmux-select-window 7'
bind-key -n C-8 run-shell 'tmux-select-window 8'
bind-key -n C-9 run-shell 'tmux-select-window 9'
bind-key -n C-0 run-shell 'tmux-select-window 10'

# Move focused pane to window
# https://github.com/alexherbo2/tmux-tools
bind-key -n C-S-1 run-shell 'tmux-move-pane-to-window 1'
bind-key -n C-S-2 run-shell 'tmux-move-pane-to-window 2'
bind-key -n C-S-3 run-shell 'tmux-move-pane-to-window 3'
bind-key -n C-S-4 run-shell 'tmux-move-pane-to-window 4'
bind-key -n C-S-5 run-shell 'tmux-move-pane-to-window 5'
bind-key -n C-S-6 run-shell 'tmux-move-pane-to-window 6'
bind-key -n C-S-7 run-shell 'tmux-move-pane-to-window 7'
bind-key -n C-S-8 run-shell 'tmux-move-pane-to-window 8'
bind-key -n C-S-9 run-shell 'tmux-move-pane-to-window 9'
bind-key -n C-S-0 run-shell 'tmux-move-pane-to-window 10'

# Detach the window in its own session
# https://github.com/alexherbo2/tmux-tools
bind-key -n C-S-d run-shell tmux-detach-window

# Select next and previous windows
bind-key -n C-[ select-window -t -1
bind-key -n C-] select-window -t +1

# Swap the current window with next/previous windows
bind-key -n C-S-[ {
  swap-window -t -1
  previous-window
}

bind-key -n C-S-] {
  swap-window -t +1
  next-window
}

# Full-screen
bind-key -n F11 resize-pane -Z

# Copy mode ────────────────────────────────────────────────────────────────────

# Enter copy mode with Control + Space.

# vi key-bindings
set-option -g mode-keys vi

# Copy mode
bind-key -n C-Space copy-mode
bind-key -T copy-mode-vi Escape send-keys -X cancel

# Copy and paste
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel wl-copy
bind-key -n C-S-v paste-buffer

# Start selection
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi M-Escape send-keys -X clear-selection

# Long jumps
bind-key -T copy-mode-vi H send-keys -X start-of-line
bind-key -T copy-mode-vi L send-keys -X end-of-line
bind-key -T copy-mode-vi J send-keys -X page-down
bind-key -T copy-mode-vi K send-keys -X page-up
